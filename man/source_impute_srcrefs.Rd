% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/source_impute_srcrefs.R
\name{source_impute_srcrefs}
\alias{source_impute_srcrefs}
\title{Source an R file and impute srcrefs on loaded functions.}
\usage{
source_impute_srcrefs(
  file,
  envir = parent.frame(),
  chdir = FALSE,
  keep.source = TRUE,
  keep.parse.data = TRUE,
  toplevel.env = as.environment(envir),
  all.names = TRUE
)
}
\arguments{
\item{file}{Path to an R source file.}

\item{envir}{Environment where the file is sourced.}

\item{chdir}{Passed to \code{\link[base:sys.source]{base::sys.source()}}.}

\item{keep.source}{Passed to \code{\link[base:sys.source]{base::sys.source()}}. Defaults to \code{TRUE}.}

\item{keep.parse.data}{Passed to \code{\link[base:sys.source]{base::sys.source()}}. Defaults to \code{TRUE}.}

\item{toplevel.env}{Passed to \code{\link[base:sys.source]{base::sys.source()}}.}

\item{all.names}{Include hidden bindings when scanning for functions.}
}
\value{
Invisibly returns a list with:
\itemize{
\item \code{file}: normalized file path
\item \code{functions}: names of patched functions
\item \code{count}: number of patched functions
\item \code{keep.source} / \code{keep.parse.data}: effective source flags
}
}
\description{
Sources a file with \code{\link[base:sys.source]{base::sys.source()}} and then rewrites function bindings
that were created or changed by that source call via \code{\link[=impute_srcrefs]{impute_srcrefs()}}.
This is the recommended entry point for source files because it can enforce
both source retention and parse-data retention.
}
\examples{
\dontrun{
tf <- tempfile(fileext = ".R")
writeLines("f <- function(x, y) if (x && y) f() else g()", tf)
env <- new.env(parent = baseenv())
source_impute_srcrefs(tf, envir = env)
env$f
}
}
